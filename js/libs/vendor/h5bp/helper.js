(function(e){function t(e,t,n,r){if("addEventListener"in e){try{e.addEventListener(t,n,r)}catch(i){if(typeof n=="object"&&n.handleEvent){e.addEventListener(t,function(e){n.handleEvent.call(n,e)},r)}else{throw i}}}else if("attachEvent"in e){if(typeof n=="object"&&n.handleEvent){e.attachEvent("on"+t,function(){n.handleEvent.call(n)})}else{e.attachEvent("on"+t,n)}}}function n(e,t,n,r){if("removeEventListener"in e){try{e.removeEventListener(t,n,r)}catch(i){if(typeof n=="object"&&n.handleEvent){e.removeEventListener(t,function(e){n.handleEvent.call(n,e)},r)}else{throw i}}}else if("detachEvent"in e){if(typeof n=="object"&&n.handleEvent){e.detachEvent("on"+t,function(){n.handleEvent.call(n)})}else{e.detachEvent("on"+t,n)}}}window.MBP=window.MBP||{};MBP.viewportmeta=e.querySelector&&e.querySelector('meta[name="viewport"]');MBP.ua=navigator.userAgent;MBP.scaleFix=function(){if(MBP.viewportmeta&&/iPhone|iPad|iPod/.test(MBP.ua)&&!/Opera Mini/.test(MBP.ua)){MBP.viewportmeta.content="width=device-width, minimum-scale=1.0, maximum-scale=1.0";e.addEventListener("gesturestart",MBP.gestureStart,false)}};MBP.gestureStart=function(){MBP.viewportmeta.content="width=device-width, minimum-scale=0.25, maximum-scale=1.6"};MBP.BODY_SCROLL_TOP=false;MBP.getScrollTop=function(){var t=window;var n=e;return t.pageYOffset||n.compatMode==="CSS1Compat"&&n.documentElement.scrollTop||n.body.scrollTop||0};MBP.hideUrlBar=function(){var e=window;if(!location.hash&&MBP.BODY_SCROLL_TOP!==false){e.scrollTo(0,MBP.BODY_SCROLL_TOP===1?0:1)}};MBP.hideUrlBarOnLoad=function(){var e=window;var t=e.document;var n;if(!e.navigator.standalone&&!location.hash&&e.addEventListener){window.scrollTo(0,1);MBP.BODY_SCROLL_TOP=1;n=setInterval(function(){if(t.body){clearInterval(n);MBP.BODY_SCROLL_TOP=MBP.getScrollTop();MBP.hideUrlBar()}},15);e.addEventListener("load",function(){setTimeout(function(){if(MBP.getScrollTop()<20){MBP.hideUrlBar()}},0)},false)}};MBP.fastButton=function(e,t,n){this.handler=t;this.pressedClass=typeof n==="undefined"?"pressed":n;MBP.listenForGhostClicks();if(e.length&&e.length>1){for(var r in e){this.addClickEvent(e[r])}}else{this.addClickEvent(e)}};MBP.fastButton.prototype.handleEvent=function(e){e=e||window.event;switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onClick(e);break;case"click":this.onClick(e);break}};MBP.fastButton.prototype.onTouchStart=function(t){var n=t.target||t.srcElement;t.stopPropagation();n.addEventListener("touchend",this,false);e.body.addEventListener("touchmove",this,false);this.startX=t.touches[0].clientX;this.startY=t.touches[0].clientY;n.className+=" "+this.pressedClass};MBP.fastButton.prototype.onTouchMove=function(e){if(Math.abs(e.touches[0].clientX-this.startX)>10||Math.abs(e.touches[0].clientY-this.startY)>10){this.reset(e)}};MBP.fastButton.prototype.onClick=function(e){e=e||window.event;var t=e.target||e.srcElement;if(e.stopPropagation){e.stopPropagation()}this.reset(e);this.handler.apply(e.currentTarget,[e]);if(e.type=="touchend"){MBP.preventGhostClick(this.startX,this.startY)}var n=new RegExp(" ?"+this.pressedClass,"gi");t.className=t.className.replace(n,"")};MBP.fastButton.prototype.reset=function(t){var r=t.target||t.srcElement;n(r,"touchend",this,false);n(e.body,"touchmove",this,false);var i=new RegExp(" ?"+this.pressedClass,"gi");r.className=r.className.replace(i,"")};MBP.fastButton.prototype.addClickEvent=function(e){t(e,"touchstart",this,false);t(e,"click",this,false)};MBP.preventGhostClick=function(e,t){MBP.coords.push(e,t);window.setTimeout(function(){MBP.coords.splice(0,2)},2500)};MBP.ghostClickHandler=function(e){if(!MBP.hadTouchEvent&&MBP.dodgyAndroid){e.stopPropagation();e.preventDefault();return}for(var t=0,n=MBP.coords.length;t<n;t+=2){var r=MBP.coords[t];var i=MBP.coords[t+1];if(Math.abs(e.clientX-r)<25&&Math.abs(e.clientY-i)<25){e.stopPropagation();e.preventDefault()}}};MBP.dodgyAndroid="ontouchstart"in window&&navigator.userAgent.indexOf("Android 2.3")!=-1;MBP.listenForGhostClicks=function(){var n=false;return function(){if(n){return}if(e.addEventListener){e.addEventListener("click",MBP.ghostClickHandler,true)}t(e.documentElement,"touchstart",function(){MBP.hadTouchEvent=true},false);n=true}}();MBP.coords=[];MBP.autogrow=function(e,t){function n(e){var t=this.scrollHeight;var n=this.clientHeight;if(t>n){this.style.height=t+3*i+"px"}}var r=t?t:12;var i=e.currentStyle?e.currentStyle.lineHeight:getComputedStyle(e,null).lineHeight;i=i.indexOf("px")==-1?r:parseInt(i,10);e.style.overflow="hidden";e.addEventListener?e.addEventListener("input",n,false):e.attachEvent("onpropertychange",n)};MBP.enableActive=function(){e.addEventListener("touchstart",function(){},false)};MBP.preventScrolling=function(){e.addEventListener("touchmove",function(e){if(e.target.type==="range"){return}e.preventDefault()},false)};MBP.preventZoom=function(){if(MBP.viewportmeta&&navigator.platform.match(/iPad|iPhone|iPod/i)){var t=e.querySelectorAll("input, select, textarea");var n="width=device-width,initial-scale=1,maximum-scale=";var r=0;var i=t.length;var s=function(){MBP.viewportmeta.content=n+"1"};var o=function(){MBP.viewportmeta.content=n+"10"};for(;r<i;r++){t[r].onfocus=s;t[r].onblur=o}}};MBP.startupImage=function(){var t;var n;var r;var i;var s;var o;r=window.devicePixelRatio;i=e.getElementsByTagName("head")[0];if(navigator.platform==="iPad"){t=r===2?"img/startup/startup-tablet-portrait-retina.png":"img/startup/startup-tablet-portrait.png";n=r===2?"img/startup/startup-tablet-landscape-retina.png":"img/startup/startup-tablet-landscape.png";s=e.createElement("link");s.setAttribute("rel","apple-touch-startup-image");s.setAttribute("media","screen and (orientation: portrait)");s.setAttribute("href",t);i.appendChild(s);o=e.createElement("link");o.setAttribute("rel","apple-touch-startup-image");o.setAttribute("media","screen and (orientation: landscape)");o.setAttribute("href",n);i.appendChild(o)}else{t=r===2?"img/startup/startup-retina.png":"img/startup/startup.png";t=screen.height===568?"img/startup/startup-retina-4in.png":t;s=e.createElement("link");s.setAttribute("rel","apple-touch-startup-image");s.setAttribute("href",t);i.appendChild(s)}if(navigator.platform.match(/iPhone|iPod/i)&&screen.height===568&&navigator.userAgent.match(/\bOS 6_/)){if(MBP.viewportmeta){MBP.viewportmeta.content=MBP.viewportmeta.content.replace(/\bwidth\s*=\s*320\b/,"width=320.1").replace(/\bwidth\s*=\s*device-width\b/,"")}}}})(document)